clear;
close all; clc;

% p_1 = [1.00000000000000000000, 182.54417942823437215338, -5728.78120341879639454419, 91664.21616994324722327292, -939703.38140954275149852037, 6547522.45779801439493894577, -30649272.29438303038477897644, 82427539.77020025253295898438, 20074267.48082194477319717407, -1417167159.60536646842956542969, 7866513694.16072273254394531250, -26892385195.03374481201171875000, 65816254012.64037322998046875000, -119151779627.43823242187500000000, 156919797571.75720214843750000000, -138672849809.74914550781250000000, 62265230645.65917968750000000000, -2311736744.35400390625000000000, 69562768671.88476562500000000000, -299693205253.04589843750000000000, 587768924788.99365234375000000000, -761207858483.36572265625000000000, 725860600990.87133789062500000000, -531311577088.20324707031250000000, 302802303486.74389648437500000000, -134118759225.65057373046875000000, 45466404275.67177581787109375000, -11431552753.47084236145019531250, 2012883688.04448890686035156250, -221893052.59248042106628417969, 11536094.07063292898237705231]
% p_2 = [3.63296, 4.35819, -501.328, 5391.42, -32356.3, 128411, -359298, 734201, -1.11886e+06, 1.28533e+06, -1.11522e+06, 725537, -347482, 118379, -26973.7, 3647.67, -181.96]
% p_3 = [5.55276, -67.956, 621.809, -4679.48, 27098.5, -118015, 385171, -944992, 1.75198e+06, -2.46398e+06, 2.62821e+06, -2.11202e+06, 1.25838e+06, -539325, 157297, -27968.4, 2324.79]
% p_4 = [5.48782, -70.5304, 680.556, -5195.28, 29607.8, -124722, 390297, -914593, 1.61712e+06, -2.16779e+06, 2.20312e+06, -1.68598e+06, 955903, -389435, 107817, -18166.7, 1441.76]



% visPolynomial(p_1, 'red')
% hold on
% visPolynomial(p_2, 'green')
% visPolynomial(p_3, 'blue')
% visPolynomial(p_4, 'cyan')

ws_bounds = [-1.2, .7, -.7, .7];
% ws_bounds = [0.0, .9, 0.0, .9];
% ws_bounds = [0, 1, 0, 1];

% p_test2d = [0.23846956516861841924, 0.84551775049842858856, 1.31618823368088833092, 0.49356502577170857649, -0.19012532624805089654, -1.01713783099741306160, -0.22660415012720847017, -0.19154690527541262668, 0.00248223658444990392, 0.36799938275353061279, 0.72010059112535174108, -0.70393997293179211283, -2.94078274138297501850, -2.78778663142941240949, -0.89714039904902165290, 0.07164672206204159011, 0.06266711646105704858, -0.00310742069154645861, 1.74326626509634330375, -0.73465290711793329592, -4.13662648218473805173, -4.36971095464036807243, 1.09652885944660738460, 6.61459955245140918123, 4.94297485873141795309, 1.79858002345707745917, 0.23480348276888207693, -1.01002802278897618748, -3.09855802723245687957, 0.15279430343935018755, 10.75222441852292831754, 14.12324137767245701980, 3.64747722349147807108, -5.30346409298476828553, -4.29423942710104711296, -0.95609507349809064181, 4.87608471994336412081, -7.88865055114524693636, -5.15720661670479785244, 4.77495999356369793531, 4.04350219986918091308, 4.62802461246974417008, 2.91432645422582936590, 2.99014433833286830122, 0.74681161613902702356, -2.39601669611316481223, -0.52402399749712458288, 13.58962106767285149544, 12.52551705415453398018, -19.95561164773152995622, -41.50362951199258532142, -28.40452905643223857624, -8.62942489672946067003, -0.96596528169908424388, 3.68027945946398915567, -4.48675981846594140734, -0.77022675947728203028, -3.09936333086807280779, -11.99173642838377418229, 1.48143702025959100865, 14.28409450161962013226, 11.58140848067148453993, 2.65720360970293434377, -2.22950062815521832249, -4.66318621652550291401, 1.53230360330377379796, 13.38568873939925651939, 20.37535377924774593339, 21.16656053031385908980, 15.94675395162761333268, 7.01513319589246009400, 1.27901650151228807317, 0.72235368615143791260, 1.83145327422640491477, 2.15736103769415876741, -4.89819277963553645350, -15.00962606649638786394, -15.15819450329436790526, -7.31820655219978277728, -1.44789145288165332914, -0.05103125854385393012];

p_test2d = [0.00894173845331034 0.00011593641540759212 0.00035897880928855233 1.2562041938931963e-5 0.08160682288734745 0.002944218069178749 0.0005119224965278824 0.19395323824773952 0.2306232487010884 0.1350970288414811 0.00029359178650901205 0.0018232310934633963 0.03786713711110607 0.00709941485998275 0.00019547127388421643 0.0023236240324913675 0.001645820569755182 0.0005475589568955044 0.0018622906351973218 0.0032237682445213933 0.009370544718857031 0.0035925659576909793 0.004597694996939956 0.0033459162825684296 0.0033690912991802867 0.007405545690551902 0.0006742539384956169 0.0009759804012198463 0.001926428019379874 0.0011334789966548247 0.00024737120774892307 0.0006862641657394957 0.0006557187861907162 0.003042752256527739 0.0015106509298703154 0.002946794180331074 0.013800989207126017 0.0020658544234042745 0.0067750757768114305 0.002135520925995285 0.002830622020426345 0.0061526084048239464 0.00030674541820560337 0.000444812157593041 0.0012321403570161164 0.0011227556160698451 0.005296811704785415 0.006433356310508382 0.01055723266711611 0.009294138330214651 0.007578395677957797 0.027966423145112378 0.00340356174229705 0.024657693674692217 0.06338485114543332 0.01047847709446604 0.0010384837915250313 0.000891027268570887 0.0004969909464340936 0.008038800419069845 0.002096355138557389 0.039794759124153374 0.003941891093018196 0.013289445058712459 0.0077696387475348835 0.005882631522116498 0.01551267407776663 0.005263345624252658 0.005191052521613616 0.005788710628863104 0.0004651161949741476 0.001157213043414778 0.003512394966641785 0.006655652899547629 0.007697850570471364 0.010379569357920166 0.011345866300647926 0.01079142447360277 0.014627734319337202 0.010235699702455239 0.020277011890141236 0.0009092699751989602 0.005547150984712585 0.008919807621138014 0.0021962227046499476 0.0026884549685856963 0.002310675593649676 0.0077124798236064 0.0038288550067069856 0.010717825254645139 0.006367239240546941 0.009350810025610223 0.012886329317413047 0.008226107996571768 0.028781323787249458 0.008825327107318957 0.01536524983547959 0.009092957964690718 0.0020422982227092 0.00507886463939623 0.0073301331424869155 0.008759625595747994 0.012789602581253374 0.00862764474334499 0.021888107260613427 0.0065215630104704155 0.06659566754793084 0.00566536466729545 0.0008426260250126654 0.19775970243557042 0.030083223743119624 0.025362016352540918 0.006507165024327362 0.006833443915153347 0.004371256953827039 0.011212659825606815 0.006302271177070151 0.011448409268629722 0.009972347892996714 0.01003174833763043 0.018610866881162143 0.00949925995407991 0.026162929269523218 0.009880135298442949 0.018154136091963664 0.011055701042716387 0.004581350451010625 0.007922004185728304 0.010631968175743745 0.009883107055378336 0.016634288313193246 0.009226253025215405 0.026837294457722694 0.00799032245178169 0.06946900522721511 0.005203832025634713 0.0245174528972304 0.008076470509649353 0.050730080995404346 0.007568664492632579 0.01241678635764637 0.00879028421974769 0.00649843315399388 0.012631300688756853 0.008254941789774954 0.013972376463572243 0.0108538585387865 0.013449178470728889 0.013573577815583321 0.01283448284112573 0.014656317558567835 0.012780498369189514 0.013703747248517136 0.013337094580321297 0.0068141638227296325 0.010263921513192345 0.011972735223659553 0.01162838162180285 0.015751729739469172 0.011043023527527791 0.020681732080672546 0.009994061373330379 0.0038441174501168737 0.039083572041491745 0.009278928355779195 0.012360710803744405 0.0209448725620565 0.00857001279787212 0.013832605417179346 0.010476423140713132 0.009361365692887005 0.012457208056029241 0.011619695538456234 0.012836313774214495 0.014160369884761102 0.012659903431909371 0.01599233251061366 0.012518607343362749 0.01629423619329416 0.012609470980286624 0.015445187972210443 0.01300346555460419 0.009096840738227856 0.01145126315072369 0.013885456474694148 0.012202994389456028 0.01635571851992733 0.011917688202776533 0.01865679721294622 0.009778803248512798 0.017263097527364487 0.011611556604159726 0.01887877305961049 0.011024384839057516 0.02231619002224466 0.010053734910468874];



% p_test2d = [5.41903114957861919976, -8.20252220285006927725, -11.43837343965641650811, 10.28966889629548120411, 27.88335374261731658407, 0.62468650249533119734, -19.70699503273789332525, -4.69097798223894812963, 2.22591919539746285750, -2.49367498807824006235, -10.91382956347055710467, 17.97134182187323858670, 65.01828594427530561006, -38.12027316252419950615, -116.80947846119627797634, 20.94840440273981130304, 66.88715183525110319351, 16.19237567500166363743, 3.62786570932786389676, -20.92295436695826538198, 4.96469584125679830322, 93.33275555707234616420, -62.78141221360147028463, -106.60293005362609619624, 63.62817696133879508125, 33.16835780834708202747, -0.12865638062106654615, 33.40108190677653965395, -38.42268826360282218957, -47.26290894321482483065, -66.45889921970228897408, 47.95648599848937010393, 268.34018051739712973358, 29.54639849363866233034, -215.15342193442188545305, -77.58893358914281179750, -14.91007834748751292864, -16.90073843981144818827, 198.01670532470234320499, -110.85829949196340749040, -299.42146795848032070353, 155.09323065616808889899, 222.51956505905400263146, -44.12413641666307739797, -82.37284057923466207285, -51.85983266340707587005, -3.33446521458836286911, 322.41650985830619902117, 52.03135850460296296660, -620.52252720455453527393, -129.57082480133976787329, 402.97615984563435631571, 161.69342494833426826517, -51.05079734950550118810, 50.72389118723526735266, -71.67737918042178080213, -167.98693735408551219734, 244.55131410077672171610, 58.74525407806777366204, -43.34778187352276290767, -2.71191510475273389602, -70.02557672572106639564, -43.28832947154842258897, 50.67933867485808718811, -81.44943288224476418691, -160.69791929674192942912, 219.88095980663422324142, 199.39925223426780576119, -144.03842464685885715880, -165.89510576550060250156, 18.83498464264596350404, 33.39640252753211768777, -8.96791886355735812231, -18.36974689450343589670, 90.76872791326758260766, 11.06729187128053126798, -107.69602023873369489593, -68.13935917416881693498, 27.20644514960133619752, 73.77653330063719749887, 21.71321809430708071886];

visPolynomial2(p_test2d, ws_bounds)
vizUnsafeSet([-.57, -.53, -.17, -.13])

eta = 0.03;

vizUnsafeSet([-1.2, -1, -0.7, 0.7])
vizUnsafeSet([0.5, 0.7, -0.7, 0.7])
vizUnsafeSet([-1, 0.5, 0.5, 0.7])
vizUnsafeSet([-1, 0.5, -0.7, -0.5])
vizUnsafeSet([-0.57, -0.53, -0.17, -0.13])
vizUnsafeSet([-0.57, -0.53, 0.28, 0.32])
vizInitSet([-0.8, -0.6, 0, 0.2], eta)



