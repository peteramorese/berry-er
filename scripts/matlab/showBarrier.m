clear;
close all; clc;

% p_1 = [1.00000000000000000000, 182.54417942823437215338, -5728.78120341879639454419, 91664.21616994324722327292, -939703.38140954275149852037, 6547522.45779801439493894577, -30649272.29438303038477897644, 82427539.77020025253295898438, 20074267.48082194477319717407, -1417167159.60536646842956542969, 7866513694.16072273254394531250, -26892385195.03374481201171875000, 65816254012.64037322998046875000, -119151779627.43823242187500000000, 156919797571.75720214843750000000, -138672849809.74914550781250000000, 62265230645.65917968750000000000, -2311736744.35400390625000000000, 69562768671.88476562500000000000, -299693205253.04589843750000000000, 587768924788.99365234375000000000, -761207858483.36572265625000000000, 725860600990.87133789062500000000, -531311577088.20324707031250000000, 302802303486.74389648437500000000, -134118759225.65057373046875000000, 45466404275.67177581787109375000, -11431552753.47084236145019531250, 2012883688.04448890686035156250, -221893052.59248042106628417969, 11536094.07063292898237705231]
% p_2 = [3.63296, 4.35819, -501.328, 5391.42, -32356.3, 128411, -359298, 734201, -1.11886e+06, 1.28533e+06, -1.11522e+06, 725537, -347482, 118379, -26973.7, 3647.67, -181.96]
% p_3 = [5.55276, -67.956, 621.809, -4679.48, 27098.5, -118015, 385171, -944992, 1.75198e+06, -2.46398e+06, 2.62821e+06, -2.11202e+06, 1.25838e+06, -539325, 157297, -27968.4, 2324.79]
% p_4 = [5.48782, -70.5304, 680.556, -5195.28, 29607.8, -124722, 390297, -914593, 1.61712e+06, -2.16779e+06, 2.20312e+06, -1.68598e+06, 955903, -389435, 107817, -18166.7, 1441.76]



% visPolynomial(p_1, 'red')
% hold on
% visPolynomial(p_2, 'green')
% visPolynomial(p_3, 'blue')
% visPolynomial(p_4, 'cyan')

ws_bounds = [-1.2, .7, -.7, .7];
% ws_bounds = [0.0, .9, 0.0, .9];
% ws_bounds = [0, 1, 0, 1];

% p_test2d = [0.23846956516861841924, 0.84551775049842858856, 1.31618823368088833092, 0.49356502577170857649, -0.19012532624805089654, -1.01713783099741306160, -0.22660415012720847017, -0.19154690527541262668, 0.00248223658444990392, 0.36799938275353061279, 0.72010059112535174108, -0.70393997293179211283, -2.94078274138297501850, -2.78778663142941240949, -0.89714039904902165290, 0.07164672206204159011, 0.06266711646105704858, -0.00310742069154645861, 1.74326626509634330375, -0.73465290711793329592, -4.13662648218473805173, -4.36971095464036807243, 1.09652885944660738460, 6.61459955245140918123, 4.94297485873141795309, 1.79858002345707745917, 0.23480348276888207693, -1.01002802278897618748, -3.09855802723245687957, 0.15279430343935018755, 10.75222441852292831754, 14.12324137767245701980, 3.64747722349147807108, -5.30346409298476828553, -4.29423942710104711296, -0.95609507349809064181, 4.87608471994336412081, -7.88865055114524693636, -5.15720661670479785244, 4.77495999356369793531, 4.04350219986918091308, 4.62802461246974417008, 2.91432645422582936590, 2.99014433833286830122, 0.74681161613902702356, -2.39601669611316481223, -0.52402399749712458288, 13.58962106767285149544, 12.52551705415453398018, -19.95561164773152995622, -41.50362951199258532142, -28.40452905643223857624, -8.62942489672946067003, -0.96596528169908424388, 3.68027945946398915567, -4.48675981846594140734, -0.77022675947728203028, -3.09936333086807280779, -11.99173642838377418229, 1.48143702025959100865, 14.28409450161962013226, 11.58140848067148453993, 2.65720360970293434377, -2.22950062815521832249, -4.66318621652550291401, 1.53230360330377379796, 13.38568873939925651939, 20.37535377924774593339, 21.16656053031385908980, 15.94675395162761333268, 7.01513319589246009400, 1.27901650151228807317, 0.72235368615143791260, 1.83145327422640491477, 2.15736103769415876741, -4.89819277963553645350, -15.00962606649638786394, -15.15819450329436790526, -7.31820655219978277728, -1.44789145288165332914, -0.05103125854385393012];

p_test2d = [0.02672052317882999892, 0.00978279431427930835, 0.22311514830050827030, 0.89605178097100157686, 1.14815865052177912276, 6.60649292559170930872, 45.22182953223943968624, 103.11319350299572761287, 63.39503398801389266737, -108.45630585423259617528, -248.40828392439016170101, -236.98151942102595057804, -132.77138217409816434156, -37.42758502634734441017, -0.11349614848344524720, 0.08282778676184765487, -0.89286276731137803608, -15.74731815364214071451, 25.90860842806728214782, 96.85082240796555197448, -434.11614414245696025318, -1462.95144982070860351087, -881.02379018109468233888, 1731.68715638811409007758, 3171.56907339956160285510, 1994.40485563057472973014, 462.20327427743382031622, 0.60213082539991091835, -1.07968270274711786172, 3.08411999404321246487, 13.17755891675346902048, 72.21323791388385870960, 412.79061878979428001912, 829.42753575834649382159, 2292.44662288113613612950, 5585.81078585927025415003, 3016.51848356644040904939, -9662.08717132467427290976, -17739.79061268718942301348, -11874.84934137134769116528, -3148.27744487345444213133, -139.82297044455890500103, 14.90958475931199167519, 9.10789334118474158686, 210.97471207184071317897, 1797.31976890252553857863, -8283.69326255512714851648, -29029.17090668145101517439, -10119.06981192939565517008, 42274.05230471468530595303, 52809.37534393230453133583, 21518.46901626512408256531, -1000.73078707978129386902, -2919.68513034470379352570, 72.12432634679134935141, 431.59315733496623579413, 2547.52940759774082835065, 3719.01856932339433114976, -13895.23526083899378136266, -48412.69623924689949490130, 41600.02100545537541620433, 251588.33359832462156191468, 129597.94296081783249974251, -327964.58294600062072277069, -445184.82104435656219720840, -106513.29825525730848312378, 168043.17407292500138282776, 133944.47236166149377822876, 17892.72569746151566505432, -8234.86731770192272961140, -31812.69520352166728116572, -40062.81948773522162809968, 167341.89579757669707760215, 411240.59990779031068086624, -172736.86717507266439497471, -1290569.61486261128447949886, -915984.40736609627492725849, 777022.58233735151588916779, 1535936.23890631273388862610, 1050594.10706013441085815430, 325486.02278763358481228352, -170.02015688130632042885, -453.94890655216295272112, 7998.73657579044811427593, 173394.33858059102203696966, 184319.30960712063824757934, -944508.84388536517508327961, -1732100.92895533051341772079, 1105027.56100076599977910519, 4412532.57550936006009578705, 2248165.56026855856180191040, -1593514.04508957639336585999, -2534601.34981391392648220062, -2990780.43193946592509746552, -2731897.14343949034810066223, -1157932.97051101643592119217, -165305.73567262012511491776, 4999.19554921798408031464, -548693.41251066722907125950, -468661.49788585375063121319, 3138936.15663348231464624405, 4188330.10764729371294379234, -5424398.34771865792572498322, -10522092.88866304233670234680, 1428608.25398938730359077454, 8208534.03990419209003448486, 878254.34070850536227226257, -1924222.93991299904882907867, 483215.90169046819210052490, 1300497.57238059118390083313, 1685796.57459813356399536133, 951495.59558794274926185608, 1153594.38679940090514719486, 828058.05194910988211631775, -6895278.73511545080691576004, -7164406.24939047265797853470, 15125009.54015107639133930206, 20329349.21113977581262588501, -14279204.01325139403343200684, -28542251.31340271979570388794, -2241845.25140631198883056641, 16172403.29006934911012649536, 16423987.79748322814702987671, 9331084.48310916870832443237, -736982.68542511761188507080, -2739681.33279334940016269684, -1791050.50758648430928587914, -1495389.88569911546073853970, 10875933.92071164026856422424, 12632833.20417557656764984131, -23939095.28233647346496582031, -38260835.54000866413116455078, 16340345.57548916339874267578, 52150397.24716496467590332031, 23668707.03621232509613037109, -6497335.36663353443145751953, -23552914.75307399034500122070, -34548999.05227565765380859375, -22221057.77233364060521125793, -3823055.53725135000422596931, 2174115.41877344483509659767, 2756571.13010237412527203560, -12887942.91359802335500717163, -22943994.48696807026863098145, 21673357.40746206790208816528, 64585614.00480973720550537109, 10407635.92936992645263671875, -58479071.84713459014892578125, -45823924.06715774536132812500, -32179356.47396230697631835938, -29120598.42205095291137695312, 34241519.32893264293670654297, 72572590.01352727413177490234, 29813663.19845817238092422485, -1837586.52658798545598983765, -4658463.45148138888180255890, 15418664.44576232880353927612, 24178106.32625553011894226074, -21652737.94842317700386047363, -40139540.03957223892211914062, -43676344.50369259715080261230, -35001371.72582435607910156250, 88927639.20826008915901184082, 148348288.28181850910186767578, 20847583.16756227612495422363, -78143638.18775117397308349609, -62544694.98451434820890426636, -18599011.97085537016391754150, 877937.11938396980985999107, 4410734.30341498833149671555, -12464636.76375422999262809753, -19275518.82206891477108001709, 43199856.19717222452163696289, -32948837.30758291110396385193, 4380535.43990391492843627930, 239354655.16809517145156860352, -144255537.02946844696998596191, -386733025.25043267011642456055, 164455971.92246067523956298828, 244746714.55952477455139160156, -59988853.47909757494926452637, -57561031.13197575509548187256, -179691.55982865564874373376, -1429662.12039354420267045498, 3653634.95495483698323369026, 7215363.04088081046938896179, -17490542.54629215225577354431, 5413435.27351830899715423584, 36939915.76682805269956588745, -105357081.45023772120475769043, -45218714.15017803013324737549, 258956732.90093132853507995605, 25506966.66939840465784072876, -271986351.01813805103302001953, 6672319.35898935794830322266, 106323366.41323839128017425537];


% p_test2d = [5.41903114957861919976, -8.20252220285006927725, -11.43837343965641650811, 10.28966889629548120411, 27.88335374261731658407, 0.62468650249533119734, -19.70699503273789332525, -4.69097798223894812963, 2.22591919539746285750, -2.49367498807824006235, -10.91382956347055710467, 17.97134182187323858670, 65.01828594427530561006, -38.12027316252419950615, -116.80947846119627797634, 20.94840440273981130304, 66.88715183525110319351, 16.19237567500166363743, 3.62786570932786389676, -20.92295436695826538198, 4.96469584125679830322, 93.33275555707234616420, -62.78141221360147028463, -106.60293005362609619624, 63.62817696133879508125, 33.16835780834708202747, -0.12865638062106654615, 33.40108190677653965395, -38.42268826360282218957, -47.26290894321482483065, -66.45889921970228897408, 47.95648599848937010393, 268.34018051739712973358, 29.54639849363866233034, -215.15342193442188545305, -77.58893358914281179750, -14.91007834748751292864, -16.90073843981144818827, 198.01670532470234320499, -110.85829949196340749040, -299.42146795848032070353, 155.09323065616808889899, 222.51956505905400263146, -44.12413641666307739797, -82.37284057923466207285, -51.85983266340707587005, -3.33446521458836286911, 322.41650985830619902117, 52.03135850460296296660, -620.52252720455453527393, -129.57082480133976787329, 402.97615984563435631571, 161.69342494833426826517, -51.05079734950550118810, 50.72389118723526735266, -71.67737918042178080213, -167.98693735408551219734, 244.55131410077672171610, 58.74525407806777366204, -43.34778187352276290767, -2.71191510475273389602, -70.02557672572106639564, -43.28832947154842258897, 50.67933867485808718811, -81.44943288224476418691, -160.69791929674192942912, 219.88095980663422324142, 199.39925223426780576119, -144.03842464685885715880, -165.89510576550060250156, 18.83498464264596350404, 33.39640252753211768777, -8.96791886355735812231, -18.36974689450343589670, 90.76872791326758260766, 11.06729187128053126798, -107.69602023873369489593, -68.13935917416881693498, 27.20644514960133619752, 73.77653330063719749887, 21.71321809430708071886];

visPolynomial2(p_test2d, ws_bounds)
vizUnsafeSet([-.57, -.53, -.17, -.13])

eta = 0.048;

vizUnsafeSet([-1.2, -1, -0.7, 0.7])
vizUnsafeSet([0.5, 0.7, -0.7, 0.7])
vizUnsafeSet([-1, 0.5, 0.5, 0.7])
vizUnsafeSet([-1, 0.5, -0.7, -0.5])
vizUnsafeSet([-0.57, -0.53, -0.17, -0.13])
vizUnsafeSet([-0.57, -0.53, 0.28, 0.32])
vizInitSet([-0.8, -0.6, 0, 0.2], eta)



