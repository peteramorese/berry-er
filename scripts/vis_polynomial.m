clear;
close all; clc;

% p_1 = [1.00000000000000000000, 182.54417942823437215338, -5728.78120341879639454419, 91664.21616994324722327292, -939703.38140954275149852037, 6547522.45779801439493894577, -30649272.29438303038477897644, 82427539.77020025253295898438, 20074267.48082194477319717407, -1417167159.60536646842956542969, 7866513694.16072273254394531250, -26892385195.03374481201171875000, 65816254012.64037322998046875000, -119151779627.43823242187500000000, 156919797571.75720214843750000000, -138672849809.74914550781250000000, 62265230645.65917968750000000000, -2311736744.35400390625000000000, 69562768671.88476562500000000000, -299693205253.04589843750000000000, 587768924788.99365234375000000000, -761207858483.36572265625000000000, 725860600990.87133789062500000000, -531311577088.20324707031250000000, 302802303486.74389648437500000000, -134118759225.65057373046875000000, 45466404275.67177581787109375000, -11431552753.47084236145019531250, 2012883688.04448890686035156250, -221893052.59248042106628417969, 11536094.07063292898237705231]
% p_2 = [3.63296, 4.35819, -501.328, 5391.42, -32356.3, 128411, -359298, 734201, -1.11886e+06, 1.28533e+06, -1.11522e+06, 725537, -347482, 118379, -26973.7, 3647.67, -181.96]
% p_3 = [5.55276, -67.956, 621.809, -4679.48, 27098.5, -118015, 385171, -944992, 1.75198e+06, -2.46398e+06, 2.62821e+06, -2.11202e+06, 1.25838e+06, -539325, 157297, -27968.4, 2324.79]
% p_4 = [5.48782, -70.5304, 680.556, -5195.28, 29607.8, -124722, 390297, -914593, 1.61712e+06, -2.16779e+06, 2.20312e+06, -1.68598e+06, 955903, -389435, 107817, -18166.7, 1441.76]



% visPolynomial(p_1, 'red')
% hold on
% visPolynomial(p_2, 'green')
% visPolynomial(p_3, 'blue')
% visPolynomial(p_4, 'cyan')

% p_1 = [1.33226, -2.94504, 5.35962, -1.82062, -1.15987, 0.32436, 0.343978, -1.14204, 6.08245, -3.66761, -11.2265, 8.77413, -5.76201, 6.13412, 6.96346, -7.59066]
% p_2 = [1.29518, 9.91237, -125.925, 522.41, -1208.31, 1755.74, -1574.82, 877.625, -310.413, 52.8058, -11.6566, -89.2114, 1133.33, -4701.69, 10874.8, -15801.7, 14173.4, -7102.7, 1581.09, -49.9871, 46.6264, 356.845, -4533.31, 18806.8, -43499.3, 63206.8, -56693.6, 26896.8, -3809.83, -834.856, -108.795, -832.639, 10577.7, -43882.5, 101498, -147482, 132305, -55536.1, -2998.29, 6705.09, 163.192, 1248.96, -15492.5, 63204.9, -144391, 208130, -185453, 50723.2, 46918.5, -25540.1, 2173.72, -14905.3, 47873.6, -95645.8, 129339, -118099, 59967.1, 85411.8, -153420, 57622.6, -9238.86, 58499.5, -158689, 234479, -182058, 16337.7, 126118, -244593, 235599, -76099.5, 13974.9, -91419.3, 253083, -385475, 344715, -157345, -21138.4, 152044, -162576, 53395.8, -9336, 63839, -183771, 298438, -318693, 249515, -142935, 25070.2, 34857.2, -16514.5, 2335.62, -16707.7, 49943.4, -85745.8, 103423, -100217, 75231.9, -33791.7, 4159.23, 1262.17]
p_precise = [1.49576430954974792797, -2.07040712381642322271, -128.06955276929357978588, 1172.73847342297585782944, -4015.07701509344587975647, 1568.61352391969671771221, 35494.29978414906508987769, -145110.99634370458079501987, 308273.84614883956965059042, -415885.33100383344572037458, 370840.03059083654079586267, -211526.07449546386487782001, 66457.99216227405122481287, -4016.81117392310625291429, -4523.56977103902318049222, 1400.36227253291349370556, -22.43646464324621803144, 31.05610685724633412974, 1921.04329153940443575266, -17591.07710134463923168369, 60226.15522640169365331531, -23529.20285879547009244561, -532414.49676223611459136009, 2176664.94515556842088699341, -4624107.69223259296268224716, 6238279.96505750156939029694, -5562600.45886254869401454926, 3186717.06381588615477085114, -1031818.74073729524388909340, 108559.47855707854614593089, 21082.78081063122226623818, -1399.67911453967826673761, 157.05525250272353332548, -217.39274800072416837793, -13447.30304077582331956364, 123137.53970941246370784938, -421583.08658481179736554623, 164704.42001156861078925431, 3726901.47733565140515565872, -15236654.61608897894620895386, 32368753.84562816098332405090, -43667959.75540252029895782471, 38938203.21203785389661788940, -22403801.07139869779348373413, 7467373.19328336510807275772, -1011401.54872639407403767109, 7432.96053671941626816988, -41635.56621199029905255884, -680.57276084513534897269, 942.03524133647260896396, 77948.90123881572799291462, -789400.31688168714754283428, 3361685.91071291593834757805, -6341414.00581659004092216492, -2080669.27070501074194908142, 40700876.50043651461601257324, -106498430.88312327861785888672, 155461656.49214544892311096191, -143407587.08288156986236572266, 83433287.88529063761234283447, -27791037.68699139729142189026, 3753943.88692439161241054535, -84759.15721943034441210330, 203604.15833353431662544608, 2041.71828253540593323123, -2826.10572400941964588128, -410941.99627553159371018410, 4670439.75391315855085849762, -23898490.55174732953310012817, 69673495.68934790790081024170, -120381126.36763030290603637695, 105819012.02223205566406250000, 15599770.61798095703125000000, -162489447.44504755735397338867, 202301119.72510319948196411133, -124934890.59706410765647888184, 39086205.64733195304870605469, -8780094.69793118163943290710, 6815856.38473434094339609146, -3068278.17688941163942217827, -4491.78022157789291668450, 6217.43259282071812776849, 1683291.67906614090315997601, -20404818.19298857450485229492, 113355783.62012189626693725586, -376138406.67291718721389770508, 821980268.39966619014739990234, -1234912551.73677873611450195312, 1296864822.25283551216125488281, -958817584.91899633407592773438, 516100904.02833545207977294922, -227402257.51125118136405944824, 72411157.34328721463680267334, 26724592.33106949552893638611, -50489901.85520600527524948120, 19032499.76646471023559570312, 7486.30036929648849763907, -10362.38765470120415557176, -4844709.72880610357969999313, 60517937.08302724361419677734, -347985746.60181415081024169922, 1210115293.20521378517150878906, -2828011985.87532234191894531250, 4676464210.47359275817871093750, -5609805703.73675251007080078125, 4914449550.05993461608886718750, -3109702654.50238656997680664062, 1352288282.91556191444396972656, -284232138.02569854259490966797, -121573764.78022854030132293701, 134592059.19189497828483581543, -42230210.79032639414072036743, -9625.24333195262806839310, 13323.06984175869729369879, 9436898.85458357632160186768, -119512598.74914807081222534180, 697633180.62815356254577636719, -2473346614.82519054412841796875, 5929725647.88591766357421875000, -10117344995.41555213928222656250, 12515962467.91557693481445312500, -11082684189.21871566772460937500, 6574520107.85023021697998046875, -1997562587.30774521827697753906, -332687915.85149741172790527344, 483588488.26315909624099731445, -65712109.40878003835678100586, -22120561.76356858015060424805, 9625.24333195262806839310, 802455.20958720508497208357, -23319529.99632944166660308838, 225750980.16380858421325683594, -1186591822.26004552841186523438, 3997030572.22982692718505859375, -9353390692.47204971313476562500, 15816056182.61041259765625000000, -19422012256.82535552978515625000, 16582793033.29096221923828125000, -8270663218.67307853698730468750, 58678367.32815980911254882812, 2955129565.42027616500854492188, -1175109751.76096343994140625000, -540691415.82124960422515869141, 335717816.94493424892425537109, 40376.56524239596910774708, -6418028.55252343229949474335, 96315886.75539568066596984863, -666595219.28070831298828125000, 2800699588.02063703536987304688, -8035053550.82094001770019531250, 16743328813.32574462890625000000, -26059668108.00743103027343750000, 30015215785.33795166015625000000, -23710211808.35169219970703125000, 9246517821.58396148681640625000, 4036225305.44684505462646484375, -7377904034.95510673522949218750, 2185639312.09231472015380859375, 1592202570.61706876754760742188, -860549561.18021476268768310547, -282685.41344857681542634964, 21432784.34046774357557296753, -288442588.05229824781417846680, 1811773250.96779561042785644531, -6883788092.98004627227783203125, 17831085102.02104949951171875000, -33549388206.02993011474609375000, 47041948018.37293243408203125000, -48167834213.18362426757812500000, 31872318140.10391998291015625000, -5717246081.62066173553466796875, -13897438951.64657402038574218750, 15671198354.34672546386718750000, -5127234121.78438282012939453125, -1795901135.56564593315124511719, 1177890816.78703927993774414062, 715901.26589285128284245729, -39318558.43692052364349365234, 514910267.14348113536834716797, -3158116033.52003479003906250000, 11615420753.25034141540527343750, -28826496510.92846298217773437500, 51174007197.20738983154296875000, -65719154723.61840057373046875000, 57390974501.90086364746093750000, -23973310693.49731826782226562500, -15964737577.63542938232421875000, 37130582392.90697479248046875000, -30758207872.70057678222656250000, 11492801371.68042564392089843750, 37828918.76808170229196548462, -917797035.43976461887359619141, -956576.73947300389409065247, 42974766.93251478672027587891, -555898014.80053985118865966797, 3382979846.46129989624023437500, -12268899169.72192382812500000000, 29734994513.25791168212890625000, -50596736253.12277984619140625000, 59543657842.62720489501953125000, -40952190361.13236236572265625000, -2767264929.82310485839843750000, 45309850333.50414276123046875000, -59022398532.95349121093750000000, 42085633561.04917907714843750000, -16469224035.35990715026855468750, 2204502523.78148508071899414062, 328788810.50378459692001342773, 717785.92892288404982537031, -28094099.75059501081705093384, 360403111.72048556804656982422, -2186476285.38730859756469726562, 7869279902.33397102355957031250, -18756246534.44054031372070312500, 30740484593.29552078247070312500, -32816523381.92651367187500000000, 14752267132.23881721496582031250, 19227920004.07528305053710937500, -47828425055.36599731445312500000, 51967310146.47617340087890625000, -34400877997.52556610107421875000, 13575052936.18825721740722656250, -2518387294.24410581588745117188, 41722731.01495900750160217285, -287154.75720551150152459741, 10211903.31765218079090118408, -130189821.45702242851257324219, 789138765.84092342853546142578, -2828170372.46860790252685546875, 6654205243.86084938049316406250, -10524507099.01688385009765625000, 10034123605.86765289306640625000, -1378928097.06857967376708984375, -13001027721.61084938049316406250, 23865930294.30069351196289062500, -23812220265.15141677856445312500, 15111952659.55882072448730468750, -5941584753.76453971862792968750, 1227495594.97270131111145019531, -76186447.51093064248561859131, 47861.36984738290630048141, -1598328.69743188354186713696, 20289855.30632284656167030334, -123043584.02477933466434478760, 439948172.82861942052841186523, -1023623932.40100896358489990234, 1561739530.76069998741149902344, -1297960887.10253930091857910156, -377668337.43376231193542480469, 2940709555.96483278274536132812, -4714784848.89575004577636718750, 4472868312.29059696197509765625, -2760212519.06491470336914062500, 1076852736.58714890480041503906, -232194886.18206024169921875000, 18637436.91596155613660812378];
visPolynomial2(p_precise)

function visPolynomial(coeffs, color)
    x = linspace(0, 1, 100);
    
    % Evaluate the polynomial
    y = polyval(flip(coeffs), x);
    
    % Plot the polynomial
    plot(x, y, 'b', 'LineWidth', 2, 'Color', color);
    xlabel('x');
    ylabel('y');
    title('Visualization of Polynomial');
    grid on;
end

function visPolynomial2(coeffs, ws_bounds)
    [x, y] = meshgrid(linspace(ws_bounds(1), ws_bounds(2), 100), linspace(ws_bounds(3), ws_bounds(4), 100));

    deg = sqrt(length(coeffs));
    coeffs = reshape(coeffs, deg, deg);
    disp(coeffs)
    
    % Evaluate the 2D polynomial
    z = polyval2(coeffs, x, y);
    
    % Plot the 2D polynomial
    surf(x, y, z);
    xlabel('x');
    ylabel('y');
    zlabel('z');
    title('Visualization of 2D Polynomial');
    colormap(jet); 
    % colorbar; % Add a colorbar to show the scale
end

function z = polyval2(coeffs, x, y)
    z = zeros(size(x));
    for grid_i = 1:size(z, 1)
        for grid_j = 1:size(z, 2)
            for j = 1:size(coeffs, 2)
                z(grid_i, grid_j) = z(grid_i, grid_j) + y(grid_i, grid_j)^(j - 1) * polyval(flip(coeffs(:, j)), x(grid_i, grid_j));
            end
        end
    end
end